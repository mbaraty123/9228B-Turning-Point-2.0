\subsection{encoders.\+c}
\label{encoders_8c_source}\index{src/encoders.\+c@{src/encoders.\+c}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "encoders.h"}
00002 
00003 \textcolor{keywordtype}{bool} imeInit() \{
00004 \textcolor{preprocessor}{  #ifdef IME\_NUMBER}
00005     \textcolor{keywordtype}{int} count = imeInitializeAll();
00006     \textcolor{keywordflow}{if}(count != IME_NUMBER) \{
00007       printf(\textcolor{stringliteral}{"detected only %d\(\backslash\)n"}, count);
00008       imeReset(0);
00009       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00010     \}
00011     imeReset(IME_FRONT_LEFT);
00012     imeReset(IME_FRONT_RIGHT);
00013     imeReset(IME_BACK_LEFT);
00014     imeReset(IME_BACK_RIGHT);
00015     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00016 \textcolor{preprocessor}{  #else}
00017     \textcolor{keywordflow}{return} imeInitializeAll()
00018   \textcolor{preprocessor}{#endif}
00019 \}
00020 
00021 \textcolor{keywordtype}{int} imeGetTicks(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} address) \{
00022   \textcolor{keywordtype}{int} i = 0;
00023   imeGet(address, &i);
00024   \textcolor{keywordflow}{return} i;
00025 \}
00026 
00027 \textcolor{keywordtype}{int} imeGetVelocityA(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} address) \{
00028   \textcolor{keywordtype}{int} i = 0;
00029   imeGetVelocity(address, &i);
00030   \textcolor{keywordflow}{return} i;
00031 \}
00032 
00033 \textcolor{keywordtype}{void} imeMoveFor(\textcolor{keywordtype}{int} ticks, Direction dir) \{
00034   \textcolor{keywordflow}{if}(dir == forward) \{
00035     \textcolor{keywordflow}{while}(\textcolor{keyword}{true}) \{
00036       \textcolor{keywordflow}{if}(imeGetAverageTicks() <= ticks) \{
00037         robotDriveStraight(forward);
00038       \}
00039   \}
00040 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(dir == reverse) \{
00041     \textcolor{keywordflow}{while}(imeGetAverageTicks() >= ticks)\{
00042       robotDriveStraight(reverse);
00043     \}
00044   \}
00045 \}
00046 
00047 
00048 \textcolor{keywordtype}{int} imeGetAverageTicks() \{
00049   \textcolor{keywordflow}{return} ((imeGetTicks(IME_FRONT_LEFT) + imeGetTicks(IME_FRONT_RIGHT) +
00050     imeGetTicks(IME_BACK_LEFT) + imeGetTicks(IME_FRONT_RIGHT)) / 4);
00051 \}
00052 
00053 \textcolor{keywordtype}{void} imeResetAll() \{
00054   imeReset(IME_FRONT_LEFT);
00055   imeReset(IME_FRONT_RIGHT);
00056   imeReset(IME_BACK_LEFT);
00057   imeReset(IME_BACK_RIGHT);
00058 \}
00059 \textcolor{comment}{/*}
00060 \textcolor{comment}{void driveDistance(int distance, int speed, void (*functionPtr)(int),}
00061 \textcolor{comment}{                           void (*start\_function)(void *)) \{}
00062 \textcolor{comment}{  //int initial = ime\_get\_average(false);}
00063 \textcolor{comment}{  TaskHandle task;}
00064 \textcolor{comment}{  if (start\_function != NULL) \{}
00065 \textcolor{comment}{    task = taskCreate(start\_function, TASK\_DEFAULT\_STACK\_SIZE, NULL,}
00066 \textcolor{comment}{                      TASK\_PRIORITY\_DEFAULT);}
00067 \textcolor{comment}{  \}}
00068 \textcolor{comment}{}
00069 \textcolor{comment}{  int initial = imeGetAverageTicks();}
00070 \textcolor{comment}{}
00071 \textcolor{comment}{  while(abs(imeGetAverageTicks() - initial) < distance)\{}
00072 \textcolor{comment}{    robotDriveForward();}
00073 \textcolor{comment}{    printf("%d", abs(imeGetAverageTicks()));}
00074 \textcolor{comment}{    wait(30);}
00075 \textcolor{comment}{  \}}
00076 \textcolor{comment}{  robotStop();}
00077 \textcolor{comment}{}
00078 \textcolor{comment}{\}*/}
\end{DoxyCode}
