\subsection{lcd.\+c}
\label{lcd_8c_source}\index{src/lcd.\+c@{src/lcd.\+c}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "lcd.h"}
00002 \textcolor{preprocessor}{#include "API.h"}
00003 
00004 \textcolor{keyword}{static} FILE *lcd\_port = NULL;
00005 
00006 \textcolor{keyword}{static} \textcolor{keywordtype}{bool} lcd\_assert() \{
00007   \textcolor{keywordflow}{if} (lcd\_port == NULL) \{
00008     printf(\textcolor{stringliteral}{"LCD NULL!"});
00009     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00010   \}
00011   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00012 \}
00013 
00014 lcd_buttons lcd_get_pressed_buttons() \{
00015   lcd\_assert();
00016   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} btn\_binary = lcdReadButtons(lcd\_port);
00017   \textcolor{keywordtype}{bool} left = btn\_binary & 0x1;   \textcolor{comment}{// 0001}
00018   \textcolor{keywordtype}{bool} middle = btn\_binary & 0x2; \textcolor{comment}{// 0010}
00019   \textcolor{keywordtype}{bool} right = btn\_binary & 0x4;  \textcolor{comment}{// 0100}
00020   lcd_buttons btns;
00021   btns.left = left ? PRESSED : RELEASED;
00022   btns.middle = middle ? PRESSED : RELEASED;
00023   btns.right = right ? PRESSED : RELEASED;
00024 
00025   \textcolor{keywordflow}{return} btns;
00026 \}
00027 
00028 \textcolor{keywordtype}{void} lcd_clear() \{
00029   lcd\_assert();
00030   lcdClear(lcd\_port);
00031 \}
00032 
00033 \textcolor{keywordtype}{void} init_main_lcd(FILE *lcd) \{
00034   lcd\_port = lcd;
00035   lcdInit(lcd);
00036   lcd_clear();
00037 \}
00038 
00039 \textcolor{keywordtype}{void} lcd_print(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} line, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *str) \{
00040   lcd\_assert();
00041   lcdSetText(lcd\_port, line, str);
00042 \}
00043 
00044 \textcolor{keywordtype}{void} lcd_set_backlight(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} state) \{
00045   lcd\_assert();
00046   lcdSetBacklight(lcd\_port, state);
00047 \}
00048 
00049 \textcolor{keywordtype}{void} promt_confirmation(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *confirm\_text) \{
00050   lcd\_assert();
00051   lcd_print(1, confirm\_text);
00052   \textcolor{keywordflow}{while} (lcd_get_pressed_buttons().middle != PRESSED) \{
00053     delay(200);
00054   \}
00055 \}
\end{DoxyCode}
